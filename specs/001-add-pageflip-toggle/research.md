# Phase 0 Research: 书页模式翻页动效开关

## 决策 1: 统一翻页状态流，按动效模式渲染

- Decision: 采用统一翻页状态流（同一翻页入口和状态机），在渲染层区分“拟真翻页 / 平移翻页 / 无动效”三种模式。
- Rationale: 可保证点击、滚轮、键盘、自动翻页在高频触发下行为一致，减少三套逻辑分叉导致的页码错乱和维护成本。
- Alternatives considered:
  - 每种动效独立实现一套翻页逻辑：实现初期较快，但一致性和回归成本高。
  - 仅加布尔锁阻止重复翻页：可防抖但会吞掉用户意图，体验生硬。

## 决策 2: 高频输入采用“最新意图优先”策略

- Decision: 连续快速翻页时，仅保留最新目标翻页意图（可选最多 1 个待处理意图），避免无限排队。
- Rationale: 阅读场景中用户更关注最终到达页，非逐条回放；可显著降低动效堆积和延迟。
- Alternatives considered:
  - 无界队列逐个播放：可完整保留输入，但在图像页面下容易产生明显积压。
  - 全量丢弃动画中输入：实现简单，但响应感不足。

## 决策 3: 动效性能基线

- Decision: 动效仅使用合成层友好属性（transform/opacity），并将拟真翻页时长控制在短时窗内；无动效模式直接切页。
- Rationale: 书页模式为图片主导，避免布局抖动可降低卡顿风险；无动效为性能与可访问性兜底。
- Alternatives considered:
  - 更重的 3D/canvas 方案：视觉更强，但复杂度和兼容成本高。
  - 统一长时动效：观感可能更华丽，但高频交互下可用性下降。

## 决策 4: 全局偏好持久化模型

- Decision: 翻页动效作为全局阅读偏好持久化，优先 userscript 存储，降级 localStorage；缺失/非法值回退默认“拟真翻页”。
- Rationale: 与已确认的“全局生效”一致；对用户最少配置成本；回退规则明确可避免脏数据导致功能不可用。
- Alternatives considered:
  - 按画集单独存储：灵活但与需求不符，且管理复杂。
  - 仅会话内生效：实现简单但违背“持续生效”目标。

## 决策 5: 可访问性动效策略

- Decision: 在用户未显式覆盖时遵循系统 reduced-motion 偏好，优先降低或关闭非必要运动；用户仍可手动选择三档动效。
- Rationale: 兼顾可访问性与用户自主选择，降低眩晕风险并保持功能完整。
- Alternatives considered:
  - 无条件播放默认拟真：对部分用户可能造成不适。
  - 强制禁用所有动效：牺牲核心拟真体验诉求。
